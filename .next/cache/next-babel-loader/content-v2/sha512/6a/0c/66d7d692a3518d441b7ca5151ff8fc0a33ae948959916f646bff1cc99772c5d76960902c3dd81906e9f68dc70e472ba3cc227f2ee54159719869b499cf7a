{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useReducer } from 'react';\nimport appContext from './appContext';\nimport appReducer from './appReducer';\nimport clientAxios from '../../config/axios';\nimport { MOSTRAR_ALERTA, LIMPIAR_ALERTA, SUBIENDO_ARCHIVO, SUBIR_ARCHIVO_EXITO, SUBIR_ARCHIVO_ERROR, CREAR_ENLACE_EXITO, AGREGAR_PASSWORD, LIMPIAR_STATE, AGREGAR_DESCARGAS, VISTA_IMAGEN } from '../../types/index';\n\nvar AppState = function AppState(_ref) {\n  var children = _ref.children;\n  var initialState = {\n    mensaje_archivo: '',\n    nombre: '',\n    nombre_original: '',\n    cargando: false,\n    descargas: 1,\n    password: '',\n    autor: null,\n    url: '',\n    image: null\n  }; // Crear dispatch y state\n\n  var _useReducer = useReducer(appReducer, initialState),\n      state = _useReducer[0],\n      dispatch = _useReducer[1]; // Mostrar alerta\n\n\n  var mostrarAlerta = function mostrarAlerta(msg) {\n    dispatch({\n      type: MOSTRAR_ALERTA,\n      payload: msg\n    });\n    setTimeout(function () {\n      dispatch({\n        type: LIMPIAR_ALERTA\n      });\n    }, 3000);\n  }; //Subir archivos al servidor\n\n\n  var subirArchivo = function subirArchivo(formData, nombreArchivo) {\n    dispatch({\n      type: SUBIENDO_ARCHIVO\n    });\n    setTimeout( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var respuesta;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return clientAxios.post('/api/files', formData);\n\n            case 3:\n              respuesta = _context.sent;\n              dispatch({\n                type: SUBIR_ARCHIVO_EXITO,\n                payload: {\n                  nombre: respuesta.data.archivo,\n                  nombre_original: nombreArchivo,\n                  image: respuesta.data.image\n                }\n              });\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              dispatch({\n                type: SUBIR_ARCHIVO_ERROR,\n                payload: _context.t0.response.data.msg\n              });\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 7]]);\n    })), 2000);\n  };\n\n  var crearEnlace = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var data, resultado;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              data = {\n                name: state.nombre,\n                original_name: state.nombre_original,\n                downloads: state.descargas,\n                password: state.password,\n                author: state.autor,\n                image: state.image\n              };\n              _context2.prev = 1;\n              _context2.next = 4;\n              return clientAxios.post('/api/links', data);\n\n            case 4:\n              resultado = _context2.sent;\n              dispatch({\n                type: CREAR_ENLACE_EXITO,\n                payload: resultado.data.msg\n              });\n              _context2.next = 10;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](1);\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 8]]);\n    }));\n\n    return function crearEnlace() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var limpiarState = function limpiarState() {\n    dispatch({\n      type: LIMPIAR_STATE\n    });\n  }; // Agregar password\n\n\n  var agregarPassword = function agregarPassword(password) {\n    dispatch({\n      type: AGREGAR_PASSWORD,\n      payload: password\n    });\n  }; // Agregar descargas\n\n\n  var agregarDescargas = function agregarDescargas(descargas) {\n    dispatch({\n      type: AGREGAR_DESCARGAS,\n      payload: descargas\n    });\n  };\n\n  var agregarImagen = function agregarImagen(imagen) {\n    dispatch({\n      type: VISTA_IMAGEN,\n      payload: URL.createObjectURL(imagen)\n    });\n  };\n\n  return /*#__PURE__*/_jsx(appContext.Provider, {\n    value: {\n      mensaje_archivo: state.mensaje_archivo,\n      nombre: state.nombre,\n      nombre_original: state.nombre_original,\n      cargando: state.cargando,\n      descargas: state.descargas,\n      password: state.password,\n      autor: state.autor,\n      url: state.url,\n      image: state.image,\n      mostrarAlerta: mostrarAlerta,\n      subirArchivo: subirArchivo,\n      crearEnlace: crearEnlace,\n      limpiarState: limpiarState,\n      agregarPassword: agregarPassword,\n      agregarDescargas: agregarDescargas,\n      agregarImagen: agregarImagen\n    },\n    children: children\n  });\n};\n\nexport default AppState;","map":null,"metadata":{},"sourceType":"module"}